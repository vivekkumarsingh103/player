<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Video Player</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        
        .video-container {
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        video {
            width: 100%;
            height: 100%;
            object-fit: contain;
            background: #000;
        }
        
        .loading-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 20px;
            z-index: 10;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid #333;
            border-top: 3px solid #0088cc;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 16px;
            color: #aaa;
        }
        
        .error-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 20px;
            padding: 20px;
            text-align: center;
            display: none;
            z-index: 20;
        }
        
        .error-icon {
            font-size: 48px;
            color: #ff6b6b;
        }
        
        .error-title {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 20px;
            font-weight: 600;
            color: #fff;
        }
        
        .error-message {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            color: #aaa;
            font-size: 14px;
            max-width: 300px;
            line-height: 1.5;
        }
        
        .retry-btn {
            background: #0088cc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        .play-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            background: rgba(0, 0, 0, 0.7);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 30px;
            cursor: pointer;
            display: none;
            z-index: 5;
            transition: all 0.3s;
        }
        
        .play-btn:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: translate(-50%, -50%) scale(1.1);
        }
        
        .controls-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
            padding: 20px;
            display: none;
            z-index: 5;
        }
        
        .progress-bar {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            width: 0%;
            height: 100%;
            background: #0088cc;
            border-radius: 2px;
            transition: width 0.1s;
        }
    </style>
</head>
<body>
    <div class="video-container">
        <div class="loading-screen" id="loadingScreen">
            <div class="spinner"></div>
            <div class="loading-text">Loading video...</div>
        </div>
        
        <div class="error-screen" id="errorScreen">
            <div class="error-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <div class="error-title" id="errorTitle">Unable to Load Video</div>
            <div class="error-message" id="errorMessage"></div>
            <button class="retry-btn" onclick="retryLoading()">
                <i class="fas fa-redo"></i> Try Again
            </button>
        </div>
        
        <video id="videoPlayer" preload="metadata" playsinline>
            <!-- Video source will be set dynamically -->
        </video>
        
        <button class="play-btn" id="playBtn" onclick="togglePlayPause()">
            <i class="fas fa-play" id="playIcon"></i>
        </button>
        
        <div class="controls-overlay" id="controlsOverlay">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <script>
        // Get video source from URL parameters or use a default
        const urlParams = new URLSearchParams(window.location.search);
        const videoUrl = urlParams.get('video') || 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4';
        
        // DOM elements
        const videoPlayer = document.getElementById('videoPlayer');
        const loadingScreen = document.getElementById('loadingScreen');
        const errorScreen = document.getElementById('errorScreen');
        const errorTitle = document.getElementById('errorTitle');
        const errorMessage = document.getElementById('errorMessage');
        const playBtn = document.getElementById('playBtn');
        const playIcon = document.getElementById('playIcon');
        const controlsOverlay = document.getElementById('controlsOverlay');
        const progressFill = document.getElementById('progressFill');
        
        let isPlaying = false;
        let hideControlsTimeout;
        
        // Initialize video player
        function initPlayer() {
            console.log('Loading video:', videoUrl);
            
            // Set video source
            videoPlayer.src = videoUrl;
            videoPlayer.load();
            
            // Event listeners
            videoPlayer.addEventListener('loadeddata', onVideoLoaded);
            videoPlayer.addEventListener('canplay', onVideoReady);
            videoPlayer.addEventListener('error', onVideoError);
            videoPlayer.addEventListener('play', onVideoPlay);
            videoPlayer.addEventListener('pause', onVideoPause);
            videoPlayer.addEventListener('timeupdate', updateProgress);
            videoPlayer.addEventListener('click', togglePlayPause);
            videoPlayer.addEventListener('dblclick', toggleFullscreen);
            
            // Timeout in case loading takes too long
            setTimeout(() => {
                if (loadingScreen.style.display !== 'none' && videoPlayer.readyState < 3) {
                    showError('Timeout', 'Taking too long to load. Try again or check your internet connection.');
                }
            }, 15000);
        }
        
        function onVideoLoaded() {
            console.log('Video metadata loaded');
        }
        
        function onVideoReady() {
            console.log('Video is ready to play');
            loadingScreen.style.display = 'none';
            
            // Auto-play if allowed
            const playPromise = videoPlayer.play();
            if (playPromise !== undefined) {
                playPromise.catch(error => {
                    console.log('Auto-play prevented, showing play button');
                    playBtn.style.display = 'flex';
                });
            }
        }
        
        function onVideoError(e) {
            console.error('Video error:', e);
            showError('Load Failed', 'Could not load the video. The file might not exist or is not accessible.');
        }
        
        function onVideoPlay() {
            isPlaying = true;
            playIcon.className = 'fas fa-pause';
            playBtn.style.display = 'none';
            showControls();
        }
        
        function onVideoPause() {
            isPlaying = false;
            playIcon.className = 'fas fa-play';
            playBtn.style.display = 'flex';
            showControls();
        }
        
        function togglePlayPause() {
            if (videoPlayer.paused || videoPlayer.ended) {
                videoPlayer.play();
            } else {
                videoPlayer.pause();
            }
            showControls();
        }
        
        function updateProgress() {
            if (videoPlayer.duration) {
                const progress = (videoPlayer.currentTime / videoPlayer.duration) * 100;
                progressFill.style.width = `${progress}%`;
            }
        }
        
        function showControls() {
            controlsOverlay.style.display = 'block';
            playBtn.style.display = isPlaying ? 'none' : 'flex';
            
            clearTimeout(hideControlsTimeout);
            if (isPlaying) {
                hideControlsTimeout = setTimeout(() => {
                    controlsOverlay.style.display = 'none';
                    playBtn.style.display = 'none';
                }, 3000);
            }
        }
        
        function showError(title, message) {
            loadingScreen.style.display = 'none';
            errorTitle.textContent = title;
            errorMessage.textContent = message;
            errorScreen.style.display = 'flex';
        }
        
        function retryLoading() {
            errorScreen.style.display = 'none';
            loadingScreen.style.display = 'flex';
            initPlayer();
        }
        
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.log(`Error attempting to enable fullscreen: ${err.message}`);
                });
            } else {
                document.exitFullscreen();
            }
        }
        
        // Progress bar click to seek
        progressFill.parentElement.addEventListener('click', (e) => {
            const rect = e.target.getBoundingClientRect();
            const pos = (e.clientX - rect.left) / rect.width;
            videoPlayer.currentTime = pos * videoPlayer.duration;
            showControls();
        });
        
        // Keyboard controls
        document.addEventListener('keydown', (e) => {
            switch(e.key.toLowerCase()) {
                case ' ':
                case 'k':
                    e.preventDefault();
                    togglePlayPause();
                    break;
                case 'arrowleft':
                    e.preventDefault();
                    videoPlayer.currentTime = Math.max(0, videoPlayer.currentTime - 10);
                    showControls();
                    break;
                case 'arrowright':
                    e.preventDefault();
                    videoPlayer.currentTime = Math.min(videoPlayer.duration, videoPlayer.currentTime + 10);
                    showControls();
                    break;
                case 'f':
                    e.preventDefault();
                    toggleFullscreen();
                    break;
                case 'm':
                    e.preventDefault();
                    videoPlayer.muted = !videoPlayer.muted;
                    showControls();
                    break;
            }
        });
        
        // Mouse movement detection
        document.addEventListener('mousemove', () => {
            if (isPlaying) {
                showControls();
            }
        });
        
        // Touch events for mobile
        document.addEventListener('touchstart', () => {
            if (isPlaying) {
                showControls();
            }
        });
        
        // Fullscreen change
        document.addEventListener('fullscreenchange', () => {
            if (document.fullscreenElement) {
                videoPlayer.style.objectFit = 'contain';
            }
        });
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initPlayer);
    </script>
</body>
</html>
